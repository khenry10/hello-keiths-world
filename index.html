<!DOCTYPE html>
<html>
<head>
  <title> Keith's Map </title>
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.css' rel='stylesheet' />
  <link rel="stylesheet" href="style.css" >
<link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />
</head>
  <body>
    <div class="navigation">
      <h1>Hello Keith's World</h1>
      <button onclick="tour()"> Tour </button>
      <button onclick="eastCoastZoom()">East Coast Zoom </button>
      <button onclick="usZoom()">US Zoom </button>
    </div>

    <div id='map' style='width: 100%; height: 89vh;'></div>
    <script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoia2VpdGhoZW5yeSIsImEiOiJjaWpleHg0OXcwMDBxdTRtNXh2bzJ1M2RuIn0.pRRgOiRIeWX5MeHFz8Be3g';

      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/streets-v8',
          center: [-99.046506, 37.477170],
          zoom: 3.8
      });

      map.on('load', function () {
          map.addSource("markers", {
              "type": "geojson",

              "data": {
                  "type": "FeatureCollection",
                  "features": [{
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-77.038832, 38.905287]
                      },
                      "properties": {
                          "title": "Socrata",
                          "description": "<div class=\"marker-title\">Socrata - leader in the open data space, In-Q-Tel funded start-up building a platform to help government and government agencies publish data. </div><p><li> October 2014 - February 2016</p>",
                          "marker-symbol": "marker"
                      }
                  }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-77.034117, 38.904839]
                      },
                      "properties": {
                          "title": "General Assembly",
                          "description": "<div class=\"marker-title\">General Assembly's Web Dev Immersive</div><p><li> February 2016 - April 2016  </p>",
                          "marker-symbol": "marker"
                      }
                  }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-73.985126, 40.753794]

                      },
                      "properties": {
                          "title": "Yahoo",
                          "description": "<div class=\"marker-title\">Yahoo Inc.</div><p><li> January 2010 - October 2011</p><p> After the Fall Harvest ended",
                          "marker-symbol": "marker"
                      }
                  }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-74.777883, 39.854799]
                      },
                      "properties": {
                          "title": "Shawnee HS",
                          "description": "<div class=\"marker-title\">Shawnee High School</div><p><li> Graduated June 2005 </p>",
                          "marker-symbol": "marker"
                      }
                  }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-73.596210, 40.715599]
                      },
                      "properties": {
                          "title": "Hofstra U",
                          "description": "<div class=\"marker-title\">Hofstra University</div><p><li> Graduated May 2009 </p>",
                          "marker-symbol": "marker"
                      }
                  }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-121.898533, 39.181551]

                      },
                      "properties": {
                          "title": "Oak Acre Farms",
                          "description": "<div class=\"marker-title\"><b>Mapbox</b></div><p><li> Fall 2009 </p><p> With the economy in the toilet, I decided to head West and help out on my buddies farm.</p><p> We did a little bit of everything from cleaning the orachards, picking fruit, boxing fruit on the assembly line, to any other odd jobs that needed to be done.</p><p> On weekends we would drive to San Fran to sell at a local farmers market and enjoy the city.</p>",
                          "marker-symbol": "marker"
                          }
                      },  {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-77.032558, 38.913184]
                      },
                      "properties": {
                          "title": "Mapbox",
                          "description": "<div class=\"marker-title\"><b>Mapbox</b></div><p><li> Spring 2016 Harvest</p><p>  </p><p> </p><p> </p>",
                          "marker-symbol": "marker"
                          }
                      }, {
                      "type": "Feature",
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-73.986601, 40.754421]

                      },
                      "properties": {
                          "title": "MediaMath",
                          "description": "<div class=\"marker-title\"><b>MediaMath</b></div><p><li> October 2011 - October 2014</p><p> 100th hire and left as the company was hitting 500.  Had a bunch of differente roles and got exposure to all sides of the business.</p><p> Did a lot of favors which made me a go-to guy for the COO, he put me on Special projects knowing I had chips to cash in and would ultimately get the job done.</p><p> Ultimately became a Product Manager, designing Private Exchanges, a $20 million business line.</p>",
                          "marker-symbol": "marker"

                      }

                  }]
              }
          });


          map.addLayer({
              "id": "markers",
              "type": "symbol",
              "source": "markers",
              "layout": {
                  "icon-image": "{marker-symbol}-15",
                  "text-field": "{title}",
                  "text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],
                  "text-offset": [0, -2],
                  "text-anchor": "top"

              }
          });
      });

      map.addControl(new  mapboxgl.Navigation())

    map.on('click', function (e) {
      var features = map.queryRenderedFeatures(e.point, { layers: ['markers'] });
      if (!features.length) {
          return;
      }

      var feature = features[0];
      console.log(feature.geometry.coordinates[0])

      // Populate the popup and set its coordinates
      // based on the feature found.

        var popup = new mapboxgl.Popup()
        .setLngLat(feature.geometry.coordinates)
        .setHTML(feature.properties.description)
        .addTo(map);


      var fly = function(){
        // 1st conditional is to to see if the market selected is Yahoo.  If yes, bearing is set to 30 to aline nicely with Manhattan's grid system
        if(feature.geometry.coordinates[0] === -73.98536682128906 && feature.geometry.coordinates[1] === 40.75401921961654){
          map.flyTo({
            center: feature.geometry.coordinates,
            zoom: 15.5,
            speed: 0.4,
            bearing: 30
          })

          // 2nd conditional is looking for Hofstra, adds bearing to align with the turnpike
        } else if (feature.geometry.coordinates[0] === -73.59603881835938 && feature.geometry.coordinates[1] === 40.71551718935035) {
          map.flyTo({
            center: feature.geometry.coordinates,
            zoom: 16.5,
            speed: 0.4,
            bearing: -25
          })
        } else {
          map.flyTo({
            center: feature.geometry.coordinates,
            zoom: 14.5,
            speed: 0.4
          })
      }
    }
    fly()

    var next = function(){
      console.log(map.markers)
    }

  })


    var eastCoastZoom = function(){
      map.flyTo({
        center: [-75.237519, 40.000987],
        zoom: 6.94,
        bearing: 0
      })
    };

    var usZoom = function(){
      map.flyTo({
        center: [-99.046506, 37.477170],
        zoom: 3.8,
        bearing: 0
      })
    }

    var tour = function(){
      //to shawnee
      console.log("to shawnee.....")
      map.flyTo({
        center: [-74.777883, 39.854799],
        zoom: 14.5,
        speed: 0.4
      })

      //to hofstra
      setTimeout(function() {
        console.log("to hofstra...")
        map.flyTo({
          center: [-73.596210, 40.715599],
          zoom: 16.5,
          speed: 0.4,
          bearing: -25
        })
    },10550)

    // to cali
    setTimeout(function() {
      console.log("to cali.....")
      map.flyTo({
        center: [-121.898533, 39.181551],
        zoom: 16.5,
        speed: 0.3,
        bearing: 0
      })
  },25000);

//to Yahoo
  setTimeout(function() {
    console.log("to yahoo.....")
    map.flyTo({
      center: [-73.985126, 40.753794],
      zoom: 16.5,
      speed: 0.4,
      bearing: 30
    })
},60000);

// to MediaMath
setTimeout(function() {
  console.log("to MediaMath.....")
  map.flyTo({
    center: [-73.986601, 40.754421],
    zoom: 16.5,
    speed: 0.1,
    bearing: 30
  })
},80000);

//to Socrata
setTimeout(function() {
  console.log("to socrata.....")
  map.flyTo({
    center: [-77.038832, 38.905287],
    zoom: 16.5,
    speed: 0.4,
    bearing: 0
  })
},90000);

//to general Assembly
setTimeout(function() {
  console.log("to GA.....")
  map.flyTo({
    center: [-77.034117, 38.904839],
    zoom: 16.5,
    speed: 0.4,
    bearing: 0
  })
},100000);

//to Mapbox
setTimeout(function() {
  console.log("to Mapbox....")
  map.flyTo({
    center: [-77.032558, 38.913184],
    zoom: 16.5,
    speed: 0.4,
    bearing: 0
  })
},150000);
    }


    </script>

  </body>
</html>
